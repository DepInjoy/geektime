# 容灾
容灾或者称为灾难恢复(Disaster Recovery，简称DR)，通过在异地建立和维护一个备份系统，利用地理上的分散性来保证数据对于灾难性事件的抵抗能力。<b>容灾系统在实现中可以分为两个层次：数据容灾和应用容灾。</b>数据容灾指建立一个异地的数据系统，作为本地关键应用数据的一个备份。应用容灾是在数据容灾的基础上，在异地建立一套完整的和本地生产系统相同的备份应用系统(可以是互为备份)。在灾难情况下，由远程系统迅速接管业务运行。

## 金融行业IT系统容灾标准
中国金融行业IT系统容灾标准采用六级分类，分为1-6级，对应不同的恢复时间目标(RTO)和数据恢复目标(RPO)。各级别的具体要求如下：
- 一级容灾标准（最高级别）：RTO：2小时内，RPO：15分钟内
适用于系统重要性最高的金融机构，如大型银行、证券公司、保险公司等。这些机构的业务连续性和数据安全至关重要，对容灾能力有最高要求。
- 二级容灾标准：RTO：4小时内，RPO：1小时内
适用于对业务连续性和数据安全有较高要求的金融机构，如中型银行、金融服务公司等。
- 三级容灾标准：RTO：8小时内，RPO：2小时内
适用于对业务连续性和数据安全有一定要求的金融机构，如小型银行、信用合作社等。
- 四级容灾标准：RTO：12小时内，RPO：4小时内
适用于对业务连续性和数据安全有较低要求的金融机构，如金融科技公司、支付机构等。
- 五级容灾标准：RTO：24小时内，RPO：8小时内
适用于对业务连续性和数据安全有一定要求但相对较低的金融机构，如小型金融科技公司、第三方支付平台等。
- 六级容灾标准（最低级别）：RTO：48小时内，RPO：24小时内
适用于对业务连续性和数据安全要求相对较低的金融机构，如小型金融服务提供商等。

## 参考资料
1. [腾讯云：容灾](https://cloud.tencent.com/developer/techpedia/1792)
2. [腾讯云：中国的金融行业IT系统容灾标准](https://cloud.tencent.com/developer/article/2314455)

# 高可用
> 高可用性是指几乎可以随时访问IT系统并保持可靠性，从而可以更大限度地消除或减少停机时间。它会结合两个概念来决定IT系统是否达到应有的运行性能水平：<b>特定设备或服务器几乎在任意时间都可访问或可用，没有停机时间；该设备或服务器在特定时间段内的性能满足合理的预期。</b>高可用性要求的不仅是满足正常运行时间服务水平协议(SLA)，或达到服务供应商与客户设定的预期，它还意味着<b>系统具有真正的弹性，能够可靠且良好地运作</b>。[1]

高可用性基础架构中，起到决定性作用的是检测和消除可能增加系统停机时间或妨碍企业达成性能目标的单点故障。基础架构的单点故障可能会使整个系统中断脱机，而复杂的系统可能存在多个单点故障。

---
要实现高可用性，企业与机构可采取的第一步是基于其核心服务、工作负载和监管或合规要求、性能基准、关键应用及运行优先级，确定其希望获得的具体、最重要的成果：
- 以遵守法规或用户体验为目的，对正常运行时间有什么要求？
- IT 环境是如何分布的？有哪些关键故障点？
- 应用必要的性能是怎样的？这种应用性能有哪些风险（如高用户流量或高写入负载）？
- 使用的存储类型是什么？
- 对数据丢失或数据访问有什么要求？
- 对于目前的 IT 资源，在断电的情况下，可实现的 SLA 是什么？目前计划的维护时间是怎样安排的，对正常运行时间有什么影响？
- 是否有针对不同灾难恢复场景或业务运营变化的计划？

高可用性环境中也有一些常见指标可供IT团队确定高可用性架构是否达到了目标。有些指标可能比其他指标更适用于您的架构，但为了设定预期的基线性能，所有指标都值得评估：
- 平均故障间隔(MTBF)：环境在系统故障之间的运行时间。
- 平均停机时间：系统在拓扑结构中恢复或被替换掉前的停机时间(分钟)。
- 恢复时间目标(RTO)：系统完成修复或重新运行所需的总时间。
- 恢复点目标(RPO)：能够恢复数据的时间段，它是可接受的丢失数据的时间窗口。

系统不可用也被称作系统故障，业界通常用多个9来衡量系统的可用性。如QQ的可用性为4个9，即99.99%可用。
```
网站不可用时间 = 故障修复时间点 - 故障发现时间点
网站年度可用性指标 = (1 - 网站不可用时间/年度总时间) * 100%
```

可用性计量表：
| 可用性级别	| 系统可用性<br>%	| 宕机时间/年	| 宕机时间/月	| 宕机时间/周	| 宕机时间/天 |
| :---: | :---: | :---: | :---: | :---: | :---: | 
|不可用	  | 90% | 36.5 天 | 73 小时	| 16.8 小时 | 144 分钟|
|基本可用 | 99% | 87.6 小时 | 7.3 小时 | 1.68 小时 | 14.4 分钟|
|较高可用	|99.9%| 8.76 小时 | 43.8 分钟 | 10.1 分钟	 | 1.44 分钟 |
|高可用	  | 99.99% | 52.56 分钟 | 	4.38 分钟 | 1.01 秒 | 8.64 秒|
|极高可用 | 99.999% | 5.26 分钟 | 26.28 秒 | 6.06 秒 | 0.86 秒 |

## 参考资料
1. [RedHat:什么是高可用](https://www.redhat.com/zh/topics/linux/what-is-high-availability#:~:text=%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7%E6%98%AF%E6%8C%87%E5%87%A0%E4%B9%8E,%E6%80%A7%E8%83%BD%E6%BB%A1%E8%B6%B3%E5%90%88%E7%90%86%E7%9A%84%E9%A2%84%E6%9C%9F%E3%80%82)
2. [系统高可用架构](https://dunwu.github.io/design/pages/9a462f/)