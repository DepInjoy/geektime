# 线程池

## 避免任务队列争抢
线程池仅具备一个任务队列供多线程共用，在同一个线程池实例上，每当有线程调用`submit()`，就把新任务压入该队列。执行任务时，工作线程不断从这个任务队列弹出任务。任务队列的争抢随着处理任务的线程数增加而加剧，这会降低性能。即便我们利用无锁队列避开显式等待，仍然会产生缓存乒乓现象，导致浪费时间。

有一种方法可解决缓存乒乓：为每个线程配备独立的任务队列。各线程只在自己的队列上提交新任务，仅当线程自身的队列没有任务时，才会从全局队列领取任务。

[采用thread_local实现线程拥有独立的任务队列，当前线程无任务时去全局队列 实现](code/src/9.1_SimpleThreadPool3.cpp)

