# 模型与语言

# 数据模型
数据模型是对现实世界数据特征的抽象，分两类：
- 概念模型也称信息模型
- 逻辑模型和物理模型，逻辑模型主要包括网状模型、层次模型、关系模型、面向对象数据模型、对象关系数据模型、半结构化数据模型等。按计算机系统的观点对数据建模，用于DBMS实现。 物理模型是对数据最底层的抽象，描述数据在系统内（磁盘上）的表示方式和存取方法。

## 组成要素
- 数据结构--描述系统的静态特性
- 数据操作--描述系统的动态特性
- 完整性约束

# 关系模型
| 人  | 事  | 物  | 理  |
|--- | --- | --- | --- |
|E.F.Codd最早提出|E.F.Codd在1970年提出, 从表(Table)及表的处理方式中抽象出来的, 是在对传统表及其操作进行数学化严格定义基础上，引入集合理论与逻辑学理论提出的| 现在大多数商品化数据库系统使用的数据模型还是关系模型，例如MySQL、Oracel等|关系模型是数据库的三大经典数据模型之一, 标准的数据库语言(SQL语言)是建立在关系模型基础之上的, 数据库领域的众多理论也都是建立在关系模型基础之上的</br>|

关系模型研究内容:
> 一个关系(relation)就是一个Table。关系模型就是处理Table的，它由三个部分组成：
> - 描述DB各种数据的基本结构形式(Table/Relation) -- **Table如何描述**
> - 描述Table与Table之间所可能发生的各种操作(关系运算) -- **有哪些操作,结果是什么？**
> - 描述这些操作所应遵循的约束条件(完整性约束) -- **有哪些约束**

## 关系模型三要素
### (一) 基本结构：Relation/Table
关系(Relation)
- 一组域$D_{1}, D_{2}, …, D_{n}$的笛卡尔积的子集
- 笛卡尔积中具有某一方面意义的那些元组被称作一个关系(Relation)
- 由于关系不同列可能来自同一个域，为了区分，为每一列起一个名字，该名字即为属性名。

关系可用$R(A_{1}:D_{1} , A_{2}:D_{2}, … ,A_{n}:D_{n})$表示，可简记为$R(A_{1} , A_{2}, … , A_{n})$，这种描述又称为关系模式(Schema)或表标题(head)。其中
- $R$是关系名, $A_{i}$是属性, $D_{i}$是属性所对应的域
- $n$是关系的度或目(Degree), 关系中元组的数目称为关系的基数(Cardinality)

关系模式$R(A_{1}:D_{1} , A_{2}:D_{2}, … ,A_{n}:D_{n})$中属性向域的映象在很多DBMS中一般直接说明为属性的类型、长度等。例如：
```sql
Student(S# char(8), Sname char(10), Ssex char(2), Sage integer,
        D# char(2), Sclass char(6) )
```

关系模式与关系
- 同一关系模式下，可有很多的关系
- 关系模式是关系的结构, 关系是关系模式在某一时刻的数据
- 关系模式是稳定的；而关系是某一时刻的值，是随时间可能变化的


### (二) 基本操作：Relation Operator 

基本操作有
$$
\begin{array}{l}
\cup(并集, UNION) \\
\ - (差集,DIFFERENCE) \\
\times(广义积) \\
\sigma (选择，SELECTION) \\
\pi (投影,PROJECTION)\\
\end{array}
$$

扩展操作有
$$
\begin{array}{l}
\cap (交,INTERSECTION) \\
\Join (连接,JOIN) \\
\div (除，DIVISION) \\
\end{array}
$$

### (三) 完整性约束
- 1. 实体完整性：关系的主码中的属性值不能为空值
> 空值：不知道或无意义的值, 数据库中有了空值，会影响许多方面, 如影响聚集函数运算的正确性，不能参与算术、比较或逻辑运算等. 
> 
> 意义：关系中的元组对应到现实世界相互之间可区分的一个个个
体，这些个体是通过主码来唯一标识的；若主码为空，则出现不可标识
的个体，不容许的。
- 2. 参照完整性：如果关系R1的外码Fk与关系R2的主码Pk相对应，则R1中的每一个元组的Fk值或者等于R2 中某个元组的Pk值, 或者为空值
> 意义：如果关系R1的某个元组t1参照了关系R2的某个元组t2，则t2必须存在
- 3. 用户自定义的完整性：用户针对具体的应用环境定义的完整性约束条件。例如性别只能是男或女。

其中，实体完整性和参照完整性属于关系的两个不变性. DBMS对关系完整性的支持
- 实体完整性和参照完整性由DBMS系统自动支持
- DBMS系统通常提供了如下机制：
  - 1. 它使用户可以自行定义有关的完整性约束条件
  - 2. 当有更新操作发生时，DBMS将自动按照完整性约束条件检验更新操作的正确性，即是否符合用户自定义的完整性

## 关系

### 关系特性

- **列是同质：即每一列中的分量来自同一域，是同一类型的数据。**

- **不同的列可来自同一个域，称其中的每一列为一个属性，不同的属性要给予不同的属性名。** 关系模式$R(A_{1}:D_{1} , A_{2}:D_{2}, … ,A_{n}:D_{n})$中，$A_i(i=1...n)$必须是不同的，而$D_i(i=1...n)$可以是相同的。
- **列位置互换性**：区分哪一列是靠列名
- **行位置互换性**：区分哪一行是靠某一或某几列的值(关键字/键字/码字)
- **关系是以内容来区分的，而不是属性在关系的位置来区分**
- 理论上，关系的任意两个元组不能完全相同。(集合的要求：集合内不能有相同的两个元素)；现实应用中，表(Table)可能并不完全遵守此特性。
- 元组相同是指两个元组的每个分量都相同
- **属性不可再分特性**:又被称为关系第一范式

### 关系相关概念
#### 1、候选码(Candidate Key)/候选键

> 关系中的一个属性组，其值能唯一标识一个元组，若从该属性组中去掉任何一个属性，它就不具有这一性质了，这样的属性组称作候选码。
> 
> 例如: 选课`(S#, C#, Sname, Cname, Grade)`，`(S#,C#)`联合起来是一个候选码

#### 2、主码(Primary Key)/主键
> 当有多个候选码时，可以选定一个作为主码。 DBMS以主码为主要线索管理关系中的各个元组。

#### 3、主属性与非主属性
> 包含在任何一个候选码中的属性被称作主属性，而其他属性被称作非主属性
> 
> 例如:选课`(S#, C#, Sname, Cname, Grade)`，`S#`和`C#`为主属性，而`Sname, Cname, Grade`则为非主属性
> 
> 最简单的，候选码只包含一个属性。
> 最极端的，所有属性构成这个关系的候选码，称为全码(All-Key)。
#### 4、外码(Foreign Key)或外键
> 关系R中的一个属性组，它不是R的候选码，但它与另一个关系S的候选码相对应，则称这个属性组为R的外码或外键。
> 
> 例如，“合同”关系中的客户号不是候选码，但却是外码。与“客户”关系中的候选码“客户号” 相对应。
> 两个关系通常是靠外码连接起来的。